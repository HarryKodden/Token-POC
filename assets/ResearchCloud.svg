<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1338px" preserveAspectRatio="none" style="width:741px;height:1338px;background:#FFFFFF;" version="1.1" viewBox="0 0 741 1338" width="741px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.4883" id="_title" style="stroke:none;stroke-width:1.0;" width="275" x="234.5" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="265" x="239.5" y="28.5352">ResearchCloud Provisioning Services</text><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="581.5" x="10" y="135.9766"/><rect fill="none" height="745.9375" style="stroke:#000000;stroke-width:1.5;" width="591.5" x="10" y="284.5293"/><rect fill="none" height="137.1738" style="stroke:#000000;stroke-width:1.5;" width="401" x="190.5" y="886.293"/><rect fill="none" height="61.9316" style="stroke:#000000;stroke-width:1.5;" width="544.5" x="190.5" y="1044.4668"/><rect fill="none" height="120.5527" style="stroke:#000000;stroke-width:1.5;" width="725" x="10" y="1120.3984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="118.9766" y2="1257.9512"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="258.5" x2="258.5" y1="118.9766" y2="1257.9512"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="554.5" x2="554.5" y1="118.9766" y2="1257.9512"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="705" x2="705" y1="118.9766" y2="1257.9512"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="116.0234">user</text><ellipse cx="38" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38,58.9883 L38,85.9883 M25,66.9883 L51,66.9883 M38,85.9883 L25,100.9883 M38,85.9883 L51,100.9883 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="1270.4863">user</text><ellipse cx="38" cy="1281.9395" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38,1289.9395 L38,1316.9395 M25,1297.9395 L51,1297.9395 M38,1316.9395 L25,1331.9395 M38,1316.9395 L51,1331.9395 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="200.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="207.5" y="108.0234">ResearchCloud</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="200.5" y="1256.9512"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="207.5" y="1277.4863">ResearchCloud</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="528.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="535.5" y="108.0234">SRAM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="528.5" y="1256.9512"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="535.5" y="1277.4863">SRAM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="685" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="692" y="108.0234">XYZ</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="685" y="1256.9512"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="692" y="1277.4863">XYZ</text><path d="M10,135.9766 L247,135.9766 L247,143.2871 L237,153.2871 L10,153.2871 L10,135.9766 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="581.5" x="10" y="135.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="25" y="149.5449">Authenticate ResearchCloud</text><polygon fill="#181818" points="247,170.5977,257,174.5977,247,178.5977,251,174.5977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="253" y1="174.5977" y2="174.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="45" y="169.8555">Logon to "ResearchCloud"</text><polygon fill="#181818" points="49,199.9082,39,203.9082,49,207.9082,45,203.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="258" y1="203.9082" y2="203.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="55" y="199.166">Redirect to SRAM</text><polygon fill="#181818" points="543,229.2188,553,233.2188,543,237.2188,547,233.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="549" y1="233.2188" y2="233.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="45" y="228.4766">Authenticate</text><polygon fill="#181818" points="270,258.5293,260,262.5293,270,266.5293,266,262.5293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="264" x2="554" y1="262.5293" y2="262.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="276" y="257.7871">Access Token (SRC)</text><path d="M10,284.5293 L192,284.5293 L192,291.8398 L182,301.8398 L10,301.8398 L10,284.5293 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="745.9375" style="stroke:#000000;stroke-width:1.5;" width="591.5" x="10" y="284.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="25" y="298.0977">Connect to Service ...</text><polygon fill="#181818" points="247,319.1504,257,323.1504,247,327.1504,251,323.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="253" y1="323.1504" y2="323.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="45" y="318.4082">Connect with a service...</text><polygon fill="#181818" points="543,348.4609,553,352.4609,543,356.4609,547,352.4609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="259" x2="549" y1="352.4609" y2="352.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="266" y="347.7188">GET /api/services/mine</text><polygon fill="#181818" points="270,377.7715,260,381.7715,270,385.7715,266,381.7715" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="264" x2="554" y1="381.7715" y2="381.7715"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272" x="276" y="377.0293">Response with all services available to user</text><polygon fill="#181818" points="49,407.082,39,411.082,49,415.082,45,411.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="258" y1="411.082" y2="411.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="55" y="406.3398">Show services</text><polygon fill="#181818" points="247,436.3926,257,440.3926,247,444.3926,251,440.3926" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="253" y1="440.3926" y2="440.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="45" y="435.6504">Select service</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26" x="134" y="435.6504">XYZ</text><polygon fill="#181818" points="543,496.3242,553,500.3242,543,504.3242,547,500.3242" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="259" x2="549" y1="500.3242" y2="500.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="266" y="464.9609">/oidc/device_authorization</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="266" y="480.2715">client_id=XYZ</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="266" y="495.582">scope=openid+offline_access</text><polygon fill="#181818" points="270,540.9453,260,544.9453,270,548.9453,266,544.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="264" x2="554" y1="544.9453" y2="544.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="276" y="524.8926">device_code="xxx"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="276" y="540.2031">verification_link=https://...</text><polygon fill="#181818" points="49,570.2559,39,574.2559,49,578.2559,45,574.2559" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="258" y1="574.2559" y2="574.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="55" y="569.5137">Present verification link to user</text><polygon fill="#181818" points="543,630.1875,553,634.1875,543,638.1875,547,634.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="259" x2="549" y1="634.1875" y2="634.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="266" y="598.8242">/oidc/token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="266" y="614.1348">grant_type=device_token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="266" y="629.4453">device_code="xxx"</text><polygon fill="#181818" points="270,659.498,260,663.498,270,667.498,266,663.498" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="264" x2="554" y1="663.498" y2="663.498"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="276" y="658.7559">pending...</text><polygon fill="#181818" points="543,688.8086,553,692.8086,543,696.8086,547,692.8086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="549" y1="692.8086" y2="692.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="45" y="688.0664">click verification link</text><polygon fill="#181818" points="49,718.1191,39,722.1191,49,726.1191,45,722.1191" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="554" y1="722.1191" y2="722.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="55" y="717.377">Authenticate + Consent</text><polygon fill="#181818" points="543,747.4297,553,751.4297,543,755.4297,547,751.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="549" y1="751.4297" y2="751.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="45" y="746.6875">Accepted !</text><polygon fill="#181818" points="543,807.3613,553,811.3613,543,815.3613,547,811.3613" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="259" x2="549" y1="811.3613" y2="811.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="266" y="775.998">/oidc/token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="266" y="791.3086">grant_type=device_token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="266" y="806.6191">device_code="xxx"</text><polygon fill="#181818" points="270,867.293,260,871.293,270,875.293,266,871.293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="264" x2="554" y1="871.293" y2="871.293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="276" y="835.9297">id_token="iii"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="276" y="851.2402">access_token="aaa"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="276" y="866.5508">refresh_token="rrr"</text><path d="M190.5,886.293 L317.5,886.293 L317.5,893.6035 L307.5,903.6035 L190.5,903.6035 L190.5,886.293 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="137.1738" style="stroke:#000000;stroke-width:1.5;" width="401" x="190.5" y="886.293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82" x="205.5" y="899.8613">repeatable...</text><polygon fill="#181818" points="543,951.5352,553,955.5352,543,959.5352,547,955.5352" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="259" x2="549" y1="955.5352" y2="955.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="266" y="920.1719">/oidc/token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="266" y="935.4824">grant_type=refresh_token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="266" y="950.793">refresh_token="rrr"</text><polygon fill="#181818" points="270,1011.4668,260,1015.4668,270,1019.4668,266,1015.4668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="264" x2="554" y1="1015.4668" y2="1015.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="276" y="980.1035">id_token="iii"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="276" y="995.4141">access_token="aaa"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="276" y="1010.7246">refresh_token="rrr"</text><path d="M190.5,1044.4668 L553.5,1044.4668 L553.5,1051.7773 L543.5,1061.7773 L190.5,1061.7773 L190.5,1044.4668 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="61.9316" style="stroke:#000000;stroke-width:1.5;" width="544.5" x="190.5" y="1044.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="318" x="205.5" y="1058.0352">Provision/Refresh workspace connected to XYZ</text><polygon fill="#181818" points="693,1094.3984,703,1098.3984,693,1102.3984,697,1098.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="259" x2="699" y1="1098.3984" y2="1098.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="266" y="1078.3457">Provision service</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="266" y="1093.6563">pass access_token "aaa"</text><path d="M10,1120.3984 L81,1120.3984 L81,1127.709 L71,1137.709 L10,1137.709 L10,1120.3984 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="120.5527" style="stroke:#000000;stroke-width:1.5;" width="725" x="10" y="1120.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26" x="25" y="1133.9668">XYZ</text><polygon fill="#181818" points="693,1155.0195,703,1159.0195,693,1163.0195,697,1159.0195" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="699" y1="1159.0195" y2="1159.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="45" y="1154.2773">User connects to service...</text><polygon fill="#181818" points="566,1199.6406,556,1203.6406,566,1207.6406,562,1203.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="560" x2="704" y1="1203.6406" y2="1203.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98" x="572" y="1183.5879">/oidc/userinfo</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="572" y="1198.8984">access_token="aaa"</text><polygon fill="#181818" points="693,1228.9512,703,1232.9512,693,1236.9512,697,1232.9512" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="555" x2="699" y1="1232.9512" y2="1232.9512"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="562" y="1228.209">user details</text><!--MD5=[97d34eb6536d1b5ae5a7ed266ebc423f]
@startuml assets/ResearchCloud

title "ResearchCloud Provisioning Services"

actor user
participant SRC as "ResearchCloud"
participant SRAM

group Authenticate ResearchCloud
user -> SRC: Logon to "ResearchCloud"
user <- SRC: Redirect to SRAM
user -> SRAM: Authenticate
SRC <- SRAM: Access Token (SRC)
end

group Connect to Service ...
user -> SRC: Connect with a service...
SRC -> SRAM: GET /api/services/mine
SRC <- SRAM: Response with all services available to user
user <- SRC: Show services
user -> SRC: Select service **XYZ**
SRC -> SRAM: **/oidc/device_authorization**\nclient_id=XYZ\nscope=openid+offline_access
SRC <- SRAM: device_code="xxx"\nverification_link=https://...
user <- SRC: Present verification link to user
SRC -> SRAM: **/oidc/token**\ngrant_type=device_token\ndevice_code="xxx"
SRC <- SRAM: pending...
user -> SRAM: click verification link
user <- SRAM: Authenticate + Consent
user -> SRAM: Accepted !
SRC -> SRAM: **/oidc/token**\ngrant_type=device_token\ndevice_code="xxx"

SRC <- SRAM: id_token="iii"\naccess_token="aaa"\nrefresh_token="rrr"
group repeatable...
SRC -> SRAM: **/oidc/token**\ngrant_type=refresh_token\nrefresh_token="rrr"
SRC <- SRAM: id_token="iii"\naccess_token="aaa"\nrefresh_token="rrr"
end
end

group Provision/Refresh workspace connected to XYZ
SRC -> XYZ: Provision service\npass access_token "aaa"
end

group XYZ
user -> XYZ: User connects to service...
XYZ -> SRAM: **/oidc/userinfo**\naccess_token="aaa"
XYZ <- SRAM: user details
end

@enduml

PlantUML version 1.2022.12(Sun Oct 23 20:12:26 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: NL
--></g></svg>