<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1336px" preserveAspectRatio="none" style="width:892px;height:1336px;background:#FFFFFF;" version="1.1" viewBox="0 0 892 1336" width="892px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.4883" id="_title" style="stroke:none;stroke-width:1.0;" width="275" x="310" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="265" x="315" y="28.5352">ResearchCloud Provisioning Services</text><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="732.5" x="10" y="135.9766"/><rect fill="none" height="624.0742" style="stroke:#000000;stroke-width:1.5;" width="732.5" x="10" y="284.5293"/><rect fill="none" height="181.7949" style="stroke:#000000;stroke-width:1.5;" width="544.5" x="341.5" y="922.6035"/><rect fill="none" height="120.5527" style="stroke:#000000;stroke-width:1.5;" width="876" x="10" y="1118.3984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="118.9766" y2="1255.9512"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="409.5" x2="409.5" y1="118.9766" y2="1255.9512"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="705.5" x2="705.5" y1="118.9766" y2="1255.9512"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="856" x2="856" y1="118.9766" y2="1255.9512"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="116.0234">user</text><ellipse cx="38" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38,58.9883 L38,85.9883 M25,66.9883 L51,66.9883 M38,85.9883 L25,100.9883 M38,85.9883 L51,100.9883 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="1268.4863">user</text><ellipse cx="38" cy="1279.9395" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38,1287.9395 L38,1314.9395 M25,1295.9395 L51,1295.9395 M38,1314.9395 L25,1329.9395 M38,1314.9395 L51,1329.9395 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="351.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="358.5" y="108.0234">ResearchCloud</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="351.5" y="1254.9512"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="358.5" y="1275.4863">ResearchCloud</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="679.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="686.5" y="108.0234">SRAM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="679.5" y="1254.9512"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="686.5" y="1275.4863">SRAM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="836" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="843" y="108.0234">XYZ</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="836" y="1254.9512"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="843" y="1275.4863">XYZ</text><path d="M10,135.9766 L247,135.9766 L247,143.2871 L237,153.2871 L10,153.2871 L10,135.9766 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="732.5" x="10" y="135.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="25" y="149.5449">Authenticate ResearchCloud</text><polygon fill="#181818" points="398,170.5977,408,174.5977,398,178.5977,402,174.5977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="404" y1="174.5977" y2="174.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="45" y="169.8555">Logon to "ResearchCloud"</text><polygon fill="#181818" points="49,199.9082,39,203.9082,49,207.9082,45,203.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="409" y1="203.9082" y2="203.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="55" y="199.166">Redirect to SRAM</text><polygon fill="#181818" points="694,229.2188,704,233.2188,694,237.2188,698,233.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="700" y1="233.2188" y2="233.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="45" y="228.4766">Authenticate</text><polygon fill="#181818" points="421,258.5293,411,262.5293,421,266.5293,417,262.5293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="415" x2="705" y1="262.5293" y2="262.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="427" y="257.7871">Access Token (SRC)</text><path d="M10,284.5293 L192,284.5293 L192,291.8398 L182,301.8398 L10,301.8398 L10,284.5293 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="624.0742" style="stroke:#000000;stroke-width:1.5;" width="732.5" x="10" y="284.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="25" y="298.0977">Connect to Service ...</text><polygon fill="#181818" points="398,319.1504,408,323.1504,398,327.1504,402,323.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="404" y1="323.1504" y2="323.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="45" y="318.4082">Connect with a service...</text><polygon fill="#181818" points="694,348.4609,704,352.4609,694,356.4609,698,352.4609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="410" x2="700" y1="352.4609" y2="352.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="417" y="347.7188">GET /api/services/mine</text><polygon fill="#181818" points="421,377.7715,411,381.7715,421,385.7715,417,381.7715" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="415" x2="705" y1="381.7715" y2="381.7715"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272" x="427" y="377.0293">Response with all services available to user</text><polygon fill="#181818" points="49,407.082,39,411.082,49,415.082,45,411.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="409" y1="411.082" y2="411.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="55" y="406.3398">Show services</text><polygon fill="#181818" points="398,436.3926,408,440.3926,398,444.3926,402,440.3926" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="404" y1="440.3926" y2="440.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="45" y="435.6504">Select service</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26" x="134" y="435.6504">XYZ</text><polygon fill="#181818" points="694,496.3242,704,500.3242,694,504.3242,698,500.3242" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="410" x2="700" y1="500.3242" y2="500.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="417" y="464.9609">/oidc/device_authorization</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="417" y="480.2715">client_id=XYZ</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="417" y="495.582">scope=openid+offline_access</text><polygon fill="#181818" points="421,540.9453,411,544.9453,421,548.9453,417,544.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="415" x2="705" y1="544.9453" y2="544.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="427" y="524.8926">device_code="xxx"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="427" y="540.2031">verification_link=https://...</text><polygon fill="#181818" points="49,570.2559,39,574.2559,49,578.2559,45,574.2559" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="409" y1="574.2559" y2="574.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="55" y="569.5137">Present verification link to user</text><polygon fill="#181818" points="694,630.1875,704,634.1875,694,638.1875,698,634.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="410" x2="700" y1="634.1875" y2="634.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="417" y="598.8242">/oidc/token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="417" y="614.1348">grant_type=device_token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="417" y="629.4453">device_code="xxx"</text><polygon fill="#181818" points="421,659.498,411,663.498,421,667.498,417,663.498" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="415" x2="705" y1="663.498" y2="663.498"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="427" y="658.7559">pending...</text><polygon fill="#181818" points="694,688.8086,704,692.8086,694,696.8086,698,692.8086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="700" y1="692.8086" y2="692.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="45" y="688.0664">click verification link</text><polygon fill="#181818" points="49,718.1191,39,722.1191,49,726.1191,45,722.1191" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="705" y1="722.1191" y2="722.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="55" y="717.377">Authenticate + Consent</text><polygon fill="#181818" points="694,747.4297,704,751.4297,694,755.4297,698,751.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="700" y1="751.4297" y2="751.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="45" y="746.6875">Accepted !</text><polygon fill="#181818" points="694,807.3613,704,811.3613,694,815.3613,698,811.3613" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="410" x2="700" y1="811.3613" y2="811.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="417" y="775.998">/oidc/token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="417" y="791.3086">grant_type=device_token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="417" y="806.6191">device_code="xxx"</text><polygon fill="#181818" points="421,867.293,411,871.293,421,875.293,417,871.293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="415" x2="705" y1="871.293" y2="871.293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="427" y="835.9297">id_token="iii"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="427" y="851.2402">access_token="aaa"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="427" y="866.5508">refresh_token="rrr"</text><polygon fill="#181818" points="49,896.6035,39,900.6035,49,904.6035,45,900.6035" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="409" y1="900.6035" y2="900.6035"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318" x="55" y="895.8613">All set ! You have succesfully connected to service</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26" x="377" y="895.8613">XYZ</text><path d="M341.5,922.6035 L791.5,922.6035 L791.5,929.9141 L781.5,939.9141 L341.5,939.9141 L341.5,922.6035 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="181.7949" style="stroke:#000000;stroke-width:1.5;" width="544.5" x="341.5" y="922.6035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="405" x="356.5" y="936.1719">[repeatable] Provision/Refresh workspace connected to XYZ</text><polygon fill="#181818" points="694,987.8457,704,991.8457,694,995.8457,698,991.8457" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="410" x2="700" y1="991.8457" y2="991.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="417" y="956.4824">/oidc/token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="417" y="971.793">grant_type=refresh_token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="417" y="987.1035">refresh_token="rrr"</text><polygon fill="#181818" points="421,1047.7773,411,1051.7773,421,1055.7773,417,1051.7773" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="415" x2="705" y1="1051.7773" y2="1051.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="427" y="1016.4141">id_token="iii"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="427" y="1031.7246">access_token="aaa"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="427" y="1047.0352">refresh_token="rrr"</text><polygon fill="#181818" points="844,1092.3984,854,1096.3984,844,1100.3984,848,1096.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="410" x2="850" y1="1096.3984" y2="1096.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="417" y="1076.3457">Provision service</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="417" y="1091.6563">pass access_token "aaa"</text><path d="M10,1118.3984 L81,1118.3984 L81,1125.709 L71,1135.709 L10,1135.709 L10,1118.3984 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="120.5527" style="stroke:#000000;stroke-width:1.5;" width="876" x="10" y="1118.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26" x="25" y="1131.9668">XYZ</text><polygon fill="#181818" points="844,1153.0195,854,1157.0195,844,1161.0195,848,1157.0195" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38" x2="850" y1="1157.0195" y2="1157.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="45" y="1152.2773">User connects to service...</text><polygon fill="#181818" points="717,1197.6406,707,1201.6406,717,1205.6406,713,1201.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="711" x2="855" y1="1201.6406" y2="1201.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98" x="723" y="1181.5879">/oidc/userinfo</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="723" y="1196.8984">access_token="aaa"</text><polygon fill="#181818" points="844,1226.9512,854,1230.9512,844,1234.9512,848,1230.9512" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="706" x2="850" y1="1230.9512" y2="1230.9512"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="713" y="1226.209">user details</text><!--MD5=[971c7ec278ccffbabf16eea0b0372b52]
@startuml assets/ResearchCloud

title "ResearchCloud Provisioning Services"

actor user
participant SRC as "ResearchCloud"
participant SRAM

group Authenticate ResearchCloud
user -> SRC: Logon to "ResearchCloud"
user <- SRC: Redirect to SRAM
user -> SRAM: Authenticate
SRC <- SRAM: Access Token (SRC)
end

group Connect to Service ...
user -> SRC: Connect with a service...
SRC -> SRAM: GET /api/services/mine
SRC <- SRAM: Response with all services available to user
user <- SRC: Show services
user -> SRC: Select service **XYZ**
SRC -> SRAM: **/oidc/device_authorization**\nclient_id=XYZ\nscope=openid+offline_access
SRC <- SRAM: device_code="xxx"\nverification_link=https://...
user <- SRC: Present verification link to user
SRC -> SRAM: **/oidc/token**\ngrant_type=device_token\ndevice_code="xxx"
SRC <- SRAM: pending...
user -> SRAM: click verification link
user <- SRAM: Authenticate + Consent
user -> SRAM: Accepted !
SRC -> SRAM: **/oidc/token**\ngrant_type=device_token\ndevice_code="xxx"
SRC <- SRAM: id_token="iii"\naccess_token="aaa"\nrefresh_token="rrr"
user <- SRC: All set ! You have succesfully connected to service **XYZ**
end

group [repeatable] Provision/Refresh workspace connected to XYZ
SRC -> SRAM: **/oidc/token**\ngrant_type=refresh_token\nrefresh_token="rrr"
SRC <- SRAM: id_token="iii"\naccess_token="aaa"\nrefresh_token="rrr"
SRC -> XYZ: Provision service\npass access_token "aaa"
end

group XYZ
user -> XYZ: User connects to service...
XYZ -> SRAM: **/oidc/userinfo**\naccess_token="aaa"
XYZ <- SRAM: **user details**\nuser_email="user@org.nl"\nuser_eppn="12345"\nuser_co="org/myCO"\nconnecting_service="ResearchCloud"
end

@enduml

PlantUML version 1.2022.12(Sun Oct 23 20:12:26 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: NL
--></g></svg>
